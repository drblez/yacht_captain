\documentclass[a4paper, 12pt, twoside, final, book, russian, fittopage, cyremdash, openright]{ncc}
\listfiles
\usepackage[a4paper]{geometry}
\geometry{verbose, tmargin=3cm, bmargin=3cm, lmargin=2cm, rmargin=1.5cm, headheight=1cm, headsep=1cm, footskip=1.5cm}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}

% The package provides several macros to adjust boxed content. One purpose is
% to supplement the standard graphics package, which defines the macros
% \resizebox, \scalebox and \rotatebox , with the macros\trimbox and \clipbox.
% The main feature is the general \adjustbox macro which extends the “key=value”
% interface of \includegraphics from the graphics package and applies it to
% general text content. Additional provided box macros are \lapbox, \marginbox,
% \minsizebox, \maxsizebox and \phantombox.
%
% export Exports the keys of \adjustbox to \includegraphics so that they can be
% used with this macro as well. Note that not all keys will works properly with
% \includegraphics as its internal code does not support all features. If problems
% occur the option Export should be used. For new documents it is recommended to
% use the macro \adjustimage{〈keys〉}{〈filename〉} instead.
\usepackage[export]{adjustbox}

% \usepackage{paratype}
% \usepackage[scaled=0.9]{PTSerif}
% \usepackage[scaled=0.9]{PTSans}
% \usepackage[scaled=0.9]{PTMono}

% The package implements the commands \Hyphdash, \Endash, \Emdash, and their
% *-forms, to control hyphenation of compound words and ordinary words dashed
% by em-dash. You can also use the shortcuts \-/, \=/, \--, \==, \---, and \=== instead.
\usepackage{extdash}

% Allows figures or tables to have text wrapped around them. Does not work in
% combination with list environments, but can be used in a parbox or minipage,
% and in twocolumn format. Supports the float package.
\usepackage{wrapfig}

% \usepackage[above,below,section]{placeins}

% The package enhances the quality of tables in LATEX, providing extra commands
% as well as behind-the-scenes optimisation. Guidelines are given as to what
% constitutes a good table in this context. From version 1.61, the package
% offers longtable compatibility.
\usepackage{booktabs}

% for tabularx environment
\usepackage{tabularx}

% for \makecell command
\usepackage{makecell}

\usepackage{longtable}
\usepackage{afterpage}
% \usepackage{xltabular}
\usepackage{hyperref}

% Define commands that appear not to eat spaces
\usepackage{xspace}

\usepackage[headings]{ncchdr}

% Use comma as decimal separator in mathematics
\usepackage{ncccomma}

% The package implements the desclist environment and redefines the description
% environment to provide an optional parameter as a prototype for calculation
% the hang indent of the list.
\usepackage{desclist}

% Indent first paragraph after section header
\usepackage{indentfirst}

% 
\usepackage{upgreek}
\usepackage{marvosym}
\usepackage{amsfonts}
% \usepackage{mathptmx}

% which provides a construction for table cells that span more than
% one row of the table;
\usepackage{multirow}

% An environment for multicolumn output
\usepackage{multicol}

\usepackage{enumitem}

% A package for rotated objects in LATEX
\usepackage{rotating}

% A new implementation of LATEX’s tabular and array environment
\usepackage{array}

% This package provides an alternative interface to the LATEX2ε graphics functions.
% The command names provided are the same as in the standard package,
% and they use the same internal functions. However the meaning of the
% optional arguments is different. 
\usepackage{graphicx}
\usepackage[font=small]{caption}
\usepackage{xfrac}
\usepackage{accents}
\usepackage{xstring}
\usepackage{catchfile}
\usepackage{float}
\usepackage{footnotehyper}

% Sometimes this makes a page-width figure appear before  a column-width
% figure that should precede it. This problem can be fixed by adding
\usepackage{stfloats}

\overfullrule=1mm

\makeindex

% висячие и другие строки

\clubpenalty=10000
\widowpenalty=10000

\righthyphenmin=2 % разрешаем переносить два последних символа

\setlength{\columnsep}{25pt}

\sloppy

\renewcommand{\bfdefault}{b} % плотный жирный

\newcommand{\mcyr}[1]{\ensuremath{\text{\textit{#1}}}}
\newcommand{\cidx}[2]{\ensuremath{#1_{\mcyr{#2}}}}
\newcommand{\lkvl}{\ensuremath{\cidx{L}{КВЛ}}\xspace}
\newcommand{\bkvl}{\ensuremath{\cidx{B}{КВЛ}}\xspace}
\newcommand{\tsr}{\ensuremath{\cidx{T}{ср}}\xspace}
\newcommand{\ve}[1]{\ensuremath{\mathbf{#1}}\xspace}
\newcommand{\gammaV}{\ensuremath{\ve{\gamma V}}\xspace}
\newcommand{\vidx}[2]{\ensuremath{\cidx{\ve #1}{#2}}\xspace}
\newcommand{\gr}{\ensuremath{^\circ}\xspace}
\newcommand{\grC}{\ensuremath{^{\circ}C}\xspace}
\newcommand{\midelsign}{\includegraphics[width=1em]{midel_sign_vec.eps}\xspace}
% \newcommand{\otdo}{\,\ensuremath{\div}\,}
\newcommand{\otdo}{--}
\newcommand{\motdo}{\div}
\newcommand{\ris}[1]{\ref{fig:#1}}
\newcommand{\rris}[1]{рис.~\ref{fig:#1}}
\newcommand{\Renum}{\ensuremath{\mathrm {Re}}}
\newcommand{\msq}{~м\ensuremath{^2}\xspace}
\newcommand{\gmsq}{~г/м$^2$\xspace}
\newcommand{\kgmsq}{~кг/м$^2$\xspace}
\newcommand{\speedms}{~м$/$с\xspace}
\newcommand{\coursespelengs}[1]{\ensuremath{\text{\textit{#1}}}\xspace}
\newcommand{\IK}{\coursespelengs{ИК}}
\newcommand{\IP}{\coursespelengs{ИП}}
\newcommand{\OIP}{\coursespelengs{ОИП}}
\newcommand{\KU}{\coursespelengs{КУ}}
\newcommand{\MK}{\coursespelengs{МК}}
\newcommand{\OP}{\coursespelengs{ОП}}
\newcommand{\OMP}{\coursespelengs{ОМП}}
\newcommand{\Klb}{\ensuremath{\text{\textit{К}}_{\text{\textit{лев.борта}}}}\xspace}
\newcommand{\Kpb}{\ensuremath{\text{\textit{К}}_{\text{\textit{пр.борта}}}}\xspace}
\newcommand{\KK}{\coursespelengs{КК}}
\newcommand{\KP}{\coursespelengs{КП}}
\newcommand{\OKP}{\coursespelengs{ОКП}}
\newcommand{\MP}{\coursespelengs{МП}}
\newcommand{\PU}{\mcyr{ПУ}\xspace}
\newcommand{\PUb}{\ensuremath{\mcyr{ПУ}_\beta}\xspace}
\newcommand{\AP}{\cidx{A}{П}\xspace}
\newcommand{\Ost}{\ensuremath{{O^{st}}}\xspace}
\newcommand{\tauAries}{\ensuremath{\uptau^{\text{\Aries}}}\xspace}
\newcommand{\tAries}{\ensuremath{t^{\text{\Aries}}}\xspace}
\newcommand{\tday}{\ensuremath{^\text{д}}\xspace}
\newcommand{\tmin}{\ensuremath{^\text{м}}\xspace}
\newcommand{\thr}{\ensuremath{^\text{ч}}\xspace}
\newcommand{\tsec}{\ensuremath{^\text{с}}\xspace}
\newcommand{\SunPower}{\ensuremath{^\text{\Sun}}}
\newcommand{\TSun}{\ensuremath{T^{\text{\Sun}}}}
\newcommand{\tSun}{\ensuremath{t^{\text{\Sun}}}}
\newcommand{\TNo}{\ensuremath{T_{\text{\No}}}\xspace}
\newcommand{\NoC} {\cidx{\No}{C}\xspace}
\newcommand{\mathNo}{\text{\No}}
\newcommand{\hhmm}[2]{\ensuremath{#1\thr~#2\tmin}}
\newcommand{\hhmmss}[3]{\ensuremath{#1\thr~#2\tmin~#3\tsec}}
\newcommand{\Tgr}{\cidx{T}{гр}\xspace}
\newcommand{\tGR}{\cidx{t}{гр}\xspace}
\newcommand{\ppp}{\ensuremath{\text{п.}}}
\newcommand{\grmm}[2]{\ensuremath{#1\gr\,#2'}}
\newcommand{\grmmss}[3]{\ensuremath{#1\gr\,#2'\,#3''}}
\newcommand{\starName}[1]{\scalebox{1.5}{\raisebox{-0.2ex}{$\ast$}}#1}
\newcommand{\starSign}{\scalebox{1.5}{\raisebox{-0.2ex}{\ast}}}
\newcommand{\SunriseA}{\ensuremath{{\widehat{\text{\Sun}}}}\xspace}
\newcommand{\Sunset} {\ensuremath{{\uwidehat{\text{\Sun}}}}\xspace}
\newcommand\bigfrac[2]{\frac{\displaystyle #1}{\displaystyle #2}}

\newcommand{\alphaStar}[1]{$\upalpha$~#1}
\newcommand{\deltaStar}[1]{$\updelta$~#1}
\newcommand{\epsilonStar}[1]{$\varepsilon$~#1}

\newcommand{\taustar}{\ensuremath{\uptau^*}\xspace}

\newcommand{\p}[1]{\paragraph{#1.}\label{par:#1}}
\newcommand{\lp}[1]{#1~\pageref{par:#1}}

\newcommand*{\appnav}[2][4]{\ref{app:#1}~\textit{#2}}

\newcolumntype{M}{>{\centering\arraybackslash}m{\dimexpr.25\linewidth-2\tabcolsep}}

\newcommand{\uhat}{\underaccent{\check}}

\newcommand{\uwidehat}[1]{%
  \mathpalette\douwidehat{#1}%
}

\makeatletter
\newcommand{\douwidehat}[2]{%
  \sbox0{$\m@th#1\widehat{\hphantom{#2}}$}%
  \sbox2{$\m@th#1x$}
  \sbox4{$\m@th#1#2$}
  \dimen0=\ht0
  \advance\dimen0 -.8\ht2
  \dimen2=\dp4
  \rlap{%
    \raisebox{\dimexpr\dimen0-\dimen2}{%
      \scalebox{1}[-1]{\box0}%
    }%
  }%
  {#2}%
}
\makeatother

\graphicspath{{pics/}}

% Set user input
\newcommand{\gitfolder}{.git}             % Relative path to .git folder from .tex file

\CatchFileDef{\headfull}{\gitfolder/HEAD}{}              % Get path to head file for checked out branch
\StrGobbleRight{\headfull}{1}[\head]                      % Remove end of line character
\StrBehind[2]{\head}{/}[\branch]                          % Parse out the path only
\CatchFileDef{\commit}{\gitfolder/refs/heads/\branch}{}  % Get the content of the branch head
\StrGobbleRight{\commit}{1}[\commithash]                  % Remove end of line character

\usepackage{tikz}
\usetikzlibrary{positioning,shapes,shadows}

\tikzstyle{abstract}=[rectangle, draw=black, rounded corners, text centered, text=black]
\tikzstyle{enter}=[rectangle, draw=white, rounded corners, text centered, text=black]

\newcommand{\keyN}[1]{%
\begin{tikzpicture} \node (Item) [abstract]{\textbf{#1}};%
\end{tikzpicture}}

\newcommand{\keyNum}[1]{%
\begin{tikzpicture} \node (Item) [enter]{\texttt{#1}};%
\end{tikzpicture}}

\newcommand{\keyGMS}{\keyN{$\circ$ ' ''}\xspace}
\newcommand{\keySHIFT}{\keyN{SHIFT}\xspace}
\newcommand{\keyRCL}{\keyN{RCL}\xspace}
\newcommand{\keySTO}{\keySHIFT\keyN{STO {\tiny RCL}}\xspace}
\newcommand{\keyALPHA}{\keyN{ALPHA}\xspace}
\newcommand{\keyA}{\keyN{A {\tiny(-)}}\xspace}
\newcommand{\keyB}{\keyN{B {\tiny $\circ$ ' ''}}\xspace}
\newcommand{\keyC}{\keyN{C {\tiny hyp}}\xspace}
\newcommand{\keyD}{\keyN{D {\tiny sin}}\xspace}
\newcommand{\keysin}{\keyN{sin}\xspace}
\newcommand{\keycos}{\keyN{cos}\xspace}
\newcommand{\keytan}{\keyN{tan}\xspace}
\newcommand{\keyarctan}{\keySHIFT \keyN{tan$^-1$ {\tiny tan}}\xspace}
\newcommand{\keyarccos}{\keySHIFT \keyN{cos$^-1$ {\tiny cos}}\xspace}
\newcommand{\keyarcsin}{\keySHIFT \keyN{sin$^-1$ {\tiny sin}}\xspace}
\newcommand{\keyRbr}{\keyN{)}\xspace}
\newcommand{\keyLbr}{\keyN{(}\xspace}
\newcommand{\keyDIV}{\keyN{$\div$}\xspace}
\newcommand{\keyPLUS}{\keyN{$+$}\xspace}
\newcommand{\keyMINUS}{\keyN{$-$}\xspace}
\newcommand{\keyANS}{\keyN{ANS}\xspace}
\newcommand{\keyEQ}{\keyN{$=$}\xspace}
\newcommand{\keySETUP}{\keySHIFT \keyN{SETUP \tiny{MODE}}\xspace}
  
\setcounter{tocdepth}{3}

\renewcommand{\topfraction}{0.8}
\renewcommand{\dbltopfraction}{0.8}
\renewcommand{\textfraction}{0.1}
\setcounter{totalnumber}{4}
\setcounter{topnumber}{4}
\setcounter{bottomnumber}{4}

% \SetTOCStyle{стиль} задает стиль оформления содержания, списка рисунков и
% таблиц. Используется в преамбуле документа. Стиль по умолчанию пуст.
% Ноапример, чтобы вывести содержание размером \small, воспользуйтесь
% командой \SetTOCStyle{\small}.
\SetTOCStyle{\small}

% \PnumPrototype{число} задает прототип номера страницы, используемого для вычисления
% величины правого отступа в содержании документа. По умолчанию прототип равен
% 99. Если в документе более 99 страниц, то вставьте команду \PnumPrototype{999} в
% преамбулу документа.
\PnumPrototype{999}

% Для всех itemize установим --- вместо жирной точки
\setlist{leftmargin=0pt,wide=0pt,noitemsep,nosep}
\setlist[itemize]{label=---}

\begin{document}

\frontmatter

\include{title}

\newpage

Адрес исходных файлов \url{https://github.com/drblez/yacht_captain}

Основано на ревизии \texttt{\commit} из ветки \texttt{\branch}.

Скомпилировано \today

\tableofcontents
\listoffigures
\listoftables

\mainmatter

\part{Основы теории и устройство крейсерских яхт}

\include{chapter1}
\include{chapter2}
\include{chapter3}
\include{chapter4}

\part{Яхтенное судовождение}

Судовождение \--- прикладная наука, рассматривающая вопросы выбора
кратчайшего пути судна и обсепечение его безопасности при плавании
между заданными пунктами в море и между морскими портами. Судовождение
состоит из четырех основных разделов: лоции, навигации (в том числе
радионавигации и девиации магнитного компаса), астронавигации и
навигационной гидрометеорологии. Здесь будут рассмотрены некоторые
теоретические и основные практические сведения из этих разделов
судовождения.

\include{chapter5}
\include{chapter6}
\include{chapter7}
\include{chapter8}
\include{chapter9}
\include{chapter10}

% \appendix
\part{Приложения}

\include{appendix1}
\include{appendix2}
\include{appendix3}
\include{appendix4}

\printindex

\end{document}

% Переход на NCC
%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% TeX-command-extra-options: "-shell-escape"
%%% End:
